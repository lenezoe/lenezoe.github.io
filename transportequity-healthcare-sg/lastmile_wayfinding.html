<!DOCTYPE html>
<html>

<head>
    <title>Walkability Assessment of SG Restructured Hospitals</title>
    <link rel="stylesheet" href="leaflet.css" />
    <style>
        body,
        html {
            margin: 0px;
            --bg0: #F3F0EC;
            --fg0: #493925;
            --strk: #01256B;
            --hder: #87200d;
            --bder: #d5d3cf;
            --contbg: #ebe9e5;
            background: var(--bg0);
            color: var(--fg0);
            font-family: Arial, Helvetica, sans-serif;
            font-size: 1rem;
        }

        #map {
            height: 100vh;
            width: 50%;
            float: left;
        }

        #sidebar {
            height: 100vh;
            width: 50%;
            float: right;
            overflow-y: auto;
            padding: 10px;
            box-sizing: border-box;
        }

        #sidebar h1 {
            font-size: 1.4rem;
            font-family: 'Indie Flower', cursive;
            color: var(--hder);
            font-weight: 600;
            padding: 15px;
            text-align: center;
        }

        #sidebar h2 {
            font-size: 1.1rem;
            color: var(--fg0);
            text-align: left;
            font-weight: 600;
            text-align: center;
        }

        #sidebar table {
            width: 100%;
        }

        #sidebar table th,
        #sidebar table td {
            padding: 8px;
            text-align: left;
        }

        #sidebar table th {
            background-color: var(--hder);
            color: white;
        }

        #sidebar a {
            display: block;
            margin-bottom: 10px;
            text-decoration: underline;
            font-weight: 600;
            color: var(--strk);
            cursor: pointer;
        }

        #sidebar a:hover {
            display: block;
            margin-bottom: 10px;
            text-decoration: none;
            font-weight: 600;
            color: var(--strk);
            cursor: pointer;
        }

        /* Tooltip content */
        .leaflet-tooltip-content {
            max-width: 200px;
            height: auto;
        }

        .leaflet-tooltip-content img {
            max-width: 100%;
            height: auto;
        }

        #scrollableContent {
            overflow-y: auto;
        }

        .content-wrapper {
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid var(--bder);
            background-color: var(--contbg);
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <div id="sidebar">
        <div id="top">
            <h1>Wayfinding</h1>
            <h2>Score for footpath segments (out of 6)</h2>
            <p>Checklist:
            <ol>
                <li>Presence of staff</li>
                <li>Presence of wayfinding signage</li>
                <li>Signage available in more than 1 location</li>
                <li>Signage in suitable position (e.g. visible from seated position)</li>
                <li>Signage clear to understand</li>
                <li>Signage do not require language skills to interpret (e.g. use of symbols or pictures for hospital,
                    type of clinic)</li>
            </ol>
            </p>
            <table>
                <thead>
                    <tr>
                        <th>Hospital Name</th>
                        <th>MRT</th>
                        <th>Bus</th>
                    </tr>
                </thead>
                <tbody id="hospitalTable"></tbody>
            </table>
            <div id="scrollableContent"></div>
        </div>
    </div>
    </div>

    <script src="leaflet.js"></script>
    <script src="papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.2/chroma.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/leaflet-polylinedecorator@1.2.0/dist/leaflet.polylineDecorator.min.js"></script>
    <script>
        // Function to get unique HTML content for each hospName
        function getUniqueHTMLForHospName(hospName, segment) {
            let content = "<div class='content-wrapper' data-segment='" + segment + "' id='segment-" + segment + "'>";
            content += "<h2>" + hospName + "</h2>";

            if (hospName === "ALEXANDRA HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Signages were only seen in 1 location towards the end of the segment, catering for vehicles rather than visitors from the bus stop (possibly because of ongoing construction works for a new direct footpath from the bus stop), leading one surveyor to miss them. Language skills or knowledge of the hospital\'s logo were required to understand the signage. The colours and font were clear, but the choice of symbols was catered more for taxis than pedestrians.<br><br><img src="survey-pictures/AH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B2\')" style="display: inline-block;">Bus route, segment B2</a></li>Two surveyors did not notice any wayfinding signage in this segment. One surveyor spotted the signage to Alexandra Hospital on the carpark gantry barrier towards AH, which was catered for drivers. It was not clear if it was more efficient for pedestrians to continue up the slope on the left, or cross the road. <br><br><img src="survey-pictures/AH-B2-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B3\')" style="display: inline-block;">Bus route, segment B3</a></li>Two surveyors noticed the presence of 1 wayfinding signage in the form of a banner in this segment. One surveyor spotted more than one signage, but felt the other signages besides the banners were either not placed in a suitable position (e.g., too low) or the font size was too small. All the wayfinding signages required language skills or knowledge of the hospital’s logo to understand.<br><br><img src="survey-pictures/AH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><img src="survey-pictures/AH-B3-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br><img src="survey-pictures/AH-B3-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B5\')" style="display: inline-block;">Bus route, segment B5</a></li> No wayfinding signage in this short segment, but segment was just in front of the hospital and visitors could walk further to seek wayfinding assistance. <br><br><img src="survey-pictures/AH-B5-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B7\')" style="display: inline-block;">Bus route, segment B7</a></li> Once in the hospital’s main lobby, there was presence of staff to seek wayfinding assistance despite the lack of wayfinding signage to the orthopaedic clinic. <br><br><img src="survey-pictures/AH-B7-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'ALEXANDRA HOSPITAL\', \'B8\')" style="display: inline-block;">Bus route, segment B8</a></li> From segment B7, visitors could navigate to the orthopaedic clinic independently after learning to follow the signages with the colour “green” or alphabet “D” to Zone D and with “E” to the orthopaedic clinic, even without language skills. Nonetheless, it could be confusing to seek “Clinic E” in “Zone D”. <br><br><img src="survey-pictures/AH-B8-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br>';

            }
            else if (hospName === "CHANGI GENERAL HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'CHANGI GENERAL HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Only one of three surveyors spotted the sign to the Main Building in this segment, but the signage still requires visitors to know that the Medical Centre is located next to the Main Building. The sign required language skills to understand<br><br><img src="survey-pictures/CGH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'CHANGI GENERAL HOSPITAL\', \'B2\')" style="display: inline-block;">Bus route, segment B2</a></li>Only one of three surveyors spotted the sign to the Medical Centre in this segment. The sign required language skills to understand and presumed visitors knew that the SOCs were within the Medical Centre. <br><img src=" survey-pictures/CGH-B2-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'CHANGI GENERAL HOSPITAL\', \'B3\')" style="display: inline-block;">Bus route, segment B3</a></li>Two of three surveyors spotted the purple floor arrow sign to the Medical Centre, and one spotted the sign to the Medical Centre on the pillar. As this segment was still on the exterior of the hospital, no staff were present to seek wayfinding assistance from. The sign required language skills to understand and presumed visitors knew that the SOCs were within the Medical Centre.<br><br><img src="survey-pictures/CGH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><img src="survey-pictures/CGH-B3-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br><img src="survey-pictures/CGH-B3-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'CHANGI GENERAL HOSPITAL\', \'B4\')" style="display: inline-block;">Bus route, segment B4</a></li>Staff was available to assist with wayfinding. There was no variety of signage available as there were only floor stickers – if one missed these, there was no other wayfinding signage. Nonetheless, it was helpful that the purple floor stickers were pasted repeatedly throughout the segment, and wall signages to the Medical Centre were in a consistent purple colour as the floor arrow stickers. This allowed visitors to navigate the area independently after learning to follow the purple signages, even without language skills.<br><img src=" survey-pictures/CGH-B4-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><br><br><img src="survey-pictures/CGH-B5-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'CHANGI GENERAL HOSPITAL\', \'B5\')" style="display: inline-block;">Bus route, segment B5</a></li> Similar to the previous segment, purple wayfinding floor stickers and wall stickers were available to aid wayfinding. <br><br><img src="survey-pictures/CGH-B5-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><br><br><img src="survey-pictures/CGH-B5-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br><br><br><img src="survey-pictures/CGH-B5-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br>';
}
            else if (hospName === "KHOO TECK PUAT HOSPITAL") {
                content +=
                '<li><a href="#" onclick="zoomToPolyline(\'KHOO TECK PUAT HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Despite the lack of staff or obvious wayfinding signage in this segment, leading to a lower score, the bus stop is right next to the hospital main entrance.<br><br><img src="survey-pictures/KTPH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/KTPH-B1-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'KHOO TECK PUAT HOSPITAL\', \'B3\')" style="display: inline-block;">Bus route, segment B3</a></li>Upon entering the KTPH building, visitors were already in Tower C which housed SOCs. There was presence of staff as well as multiple signages in the main lobby directing visitors to respective SOCs. Different Towers’ signages were in different colours, aiding visitors from other parts of the hospital to follow the “Blue” signages. The clinic signages also used pictures to indicate which specialty the clinics served, in addition to alphabets.<br><br><img src="survey-pictures/KTPH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/KTPH-B3-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br>';
}
            else if (hospName === "NATIONAL UNIVERSITY HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'NATIONAL UNIVERSITY HOSPITAL\', \'M1\')" style="display: inline-block;"> MRT route, segment M1</a></li>At the Kent Ridge MRT station, visitors had to ensure they sought “Kent Ridge Wing” or “Zone C” in the wayfinding signage instead of “NUH Main Bldg”, to access the orthopaedic clinic by Exit C. Going by Exit A would have resulted in a much longer route to Zone C. <br><br>Within the Medical Centre, staff was available to assist with wayfinding, and there was more than one clear wayfinding signage in different positions. Visitors could navigate to the orthopaedic clinic independently after learning to follow the signages with the alphabet “C”, even without language skills.<br><br><img src="survey-pictures/NUH-M1-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/NUH-M1-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/NUH-M1-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'NATIONAL UNIVERSITY HOSPITAL\', \'M2\')" style="display: inline-block;"> MRT route, segment M2</a></li> Staff was available to assist with wayfinding, and there was more than one clear wayfinding signage in different positions. Visitors could navigate to the orthopaedic clinic independently after learning to follow the signages with the alphabet “C”, even without language skills. The message in the lift informing visitors of which storey the link bridge was on, might require language skills to understand. <br><br><img src="survey-pictures/NUH-M2-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/NUH-M2-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'NATIONAL UNIVERSITY HOSPITAL\', \'M3\')" style="display: inline-block;"> MRT route, segment M3/B3</a></li>Staff was available to assist with wayfinding, and there was more than one clear wayfinding signage in different positions. Visitors could navigate to the orthopaedic clinic independently after learning to follow the signages with the alphabet “C”, even without language skills.<br><br><img src="survey-pictures/NUH-M3-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/NUH-M3-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/NUH-M3-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br><li>Bus route, <a href="#" onclick="zoomToPolyline(\'NATIONAL UNIVERSITY HOSPITAL\', \'B1\')" style="display: inline-block;">segment B1</a>, <a href="#" onclick="zoomToPolyline(\'NATIONAL UNIVERSITY HOSPITAL\', \'B2\')" style="display: inline-block;">segment B2</a></li>On Google Maps, the "Kent Ridge Station" bus stop was nearest to the NUH Medical Centre (compared to the bus stop at Kent Ridge MRT Exit A), but no presence of any signage from the bus stop towards the hospital. One must know which direction to turn to walk towards the NUH building, which might be challenging for first-time visitors. Visitors unfamiliar with the area might be tempted to cross the road to the Kent Ridge MRT station to seek staff to ask for directions. <br><img src="survey-pictures/NUH-B1-incline.jpg" style="max-width: 100%; height: auto;"><br><img src=" survey-pictures/NUH-B2-incline.jpg" style="max-width: 100%; height: auto;"><br><br>';
}
            else if (hospName === "NG TENG FONG GENERAL HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'NG TENG FONG GENERAL HOSPITAL\', \'M1\')" style="display: inline-block;">MRT route, segment M1</a></li>Pedestrians had to walk from the Jurong East MRT station through the “Westgate” shopping mall to get to NTFGH’s Tower A. Besides the use of consistent arrows, the signages were in English, necessitating visitors to have language skills or ask for wayfinding assistance from others.<br><br><img src="survey-pictures/NTFGH-M1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'NG TENG FONG GENERAL HOSPITAL\', \'M2\')" style="display: inline-block;">MRT route, segment M2</a></li>There is a map that indicated that Tower A was the building that housed SOCs within NTFGH. This was absent in the bus stop route. There was use of colours and alphabets to indicate directions to NTFGH’s Tower A.<br><br><img src="survey-pictures/NTFGH-M2-wayfinding.jpg" style="max-width: 100%; height: auto;"> .<br><br><img src="survey-pictures/NTFGH-M2-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br> <li><a href="#" onclick="zoomToPolyline(\'NG TENG FONG GENERAL HOSPITAL\', \'B1\')" style="display: inline-block;"> Bus route, segment B1</a></li>The bus stop was in front of Ng Teng Fong General Hospital’s Tower B. Only one of three surveyors noticed a wayfinding signage towards Tower A from the bus stop. It is assumed that visitors know that the specialist outpatient clinics are in Tower A. <br><br><img src="survey-pictures/NTFGH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li>Bus route, <a href="#" onclick="zoomToPolyline(\'NG TENG FONG GENERAL HOSPITAL\', \'B2\')" style="display: inline-block;">segment B2</a>, <a href="#" onclick="zoomToPolyline(\'NG TENG FONG GENERAL HOSPITAL\', \'B3\')" style="display: inline-block;"> segment B3</a ></li>Beyond the initial wayfinding signage to Tower A, there were no further directions from the bus stop to Tower A. Visitors must enter the main entrance of Tower B to discover that a lift within Tower B would bring them to the linkbridge to Tower A. <br><br><img src="survey-pictures/NTFGH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br>';

            }
            else if (hospName === "SENGKANG GENERAL HOSPITAL") {
                content +=
                '<li>MRT route, <a href="#" onclick="zoomToPolyline(\'SENGKANG GENERAL HOSPITAL\', \'M1\')" style="display: inline-block;">segment M1</a>, <a href="#" onclick="zoomToPolyline(\'SENGKANG GENERAL HOSPITAL\', \'M2\')" style="display: inline-block;">segment M2</a></li> Despite the lack of staff or obvious wayfinding signage in this segment, leading to a lower score, the Cheng Lim LRT exit B is right next to the hospital’s emergency department entrance. <br><br><img src="survey-pictures/SKH-M1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><img src="survey-pictures/SKH-M2-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'SENGKANG GENERAL HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Despite the lack of staff or obvious wayfinding signage in this segment, leading to a lower score, the bus stop is right next to the SKH Medical Centre. The words "Sengkang General Hospital” are on the building façade and bus stop sign itself. <br><br><img src="survey-pictures/SKH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'SENGKANG GENERAL HOSPITAL\', \'M8/B3\')" style="display: inline-block;">MRT/Bus route, segment M8/B3</a></li>Inside the SKH Medical Centre ground lobby, there was staff present who could provide directions assistance to the orthopaedic clinic despite the lack of information in the wayfinding directory located in the lobby on the ground floor of the Medical Centre. There was redundant detailed information about other parts of the hospital in the directory, which could be better placed outside the Medical Centre<br><br><img src="survey-pictures/SKH-M8-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><img src="survey-pictures/SKH-M8-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br>';
            }
            else if (hospName === "SINGAPORE GENERAL HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Numerous signages towards Singapore General Hospital, which were visible and clear from a seated position. However, unless the visitors were able to read the sign or were familiar with the different surrounding facilities’ logos, they could be difficult to understand. While this was not part of the evaluation metric, the presence of numerous visitors and staff along this segment could be useful for wayfinding.<br><br><img src="survey-pictures/SGH-B1-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><br><img src="survey-pictures/SGH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br><img src="survey-pictures/SGH-B1-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B2\')" style="display: inline-block;">Bus route, segment B2</a></li>Visitors were likely to have no issues navigating this segment as there was only one path given the construction works. Nonetheless, there was 1 wayfinding signage, visible from a seated position. However, the design and content was similar to previous signages - unless the visitors were able to read the sign or were familiar with the different surrounding facilities’ logos, they could be difficult to understand.<br><br><img src="survey-pictures/SGH-B2-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B3\')" style="display: inline-block;">Bus route, segment B3</a></li>There was more than one wayfinding signage, and they were clear from a seated position. The design and content of the signages were similar to previous signages, which meant visitors still required language skills or knowledge of the logos to interpret them. The fact there was only a single route available would overcome wayfinding challenges after previous segments. <br><br><img src="survey-pictures/SGH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B4\')" style="display: inline-block;">Bus route, segment B4</a></li>There was 1 wayfinding signage. The design and content of the signage was similar to previous signages. The fact there was only a single route available would overcome wayfinding challenges after previous segments. <br><br><img src="survey-pictures/SGH-B4-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B6\')" style="display: inline-block;">Bus route, segment B6</a></li>One of the surveyors did not notice the signage, although those who noticed it felt it was visible from a seated position. The design and content of the signage was similar to previous signages.<br><br>One of the surveyors did not notice the signage, although those who noticed it felt it was visible from a seated position. There was another set of signages which did not direct to Singapore General Hospital. First-time visitors who cannot read might be confused.<br><br><img src="survey-pictures/SGH-B6-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B8\')" style="display: inline-block;">Bus route, segment B8</a></li>One of the surveyors did not notice the signage, although those who noticed it felt it was visible from a seated position and clear. There was another set of signages which did not direct to Singapore General Hospital, which might confuse illiterate visitors.<br><br><img src="survey-pictures/SGH-B8-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/SGH-B8-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'SINGAPORE GENERAL HOSPITAL\', \'B10\')" style="display: inline-block;">Bus route, segment B10</a></li>The signage towards the Musculoskeletal Centre (MSC) in this segment was clear and visible. There was some use of pictorial icons in the signage to aid wayfinding for illiterate visitors. However, the choice of icons for the MSC were the same as various other clinics, hence their usefulness was limited.<br><br><img src="survey-pictures/SGH-B10-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br>';
            }
            else if (hospName === "TAN TOCK SENG HOSPITAL") {
                content +=
                    '<li><a href="#" onclick="zoomToPolyline(\'TAN TOCK SENG HOSPITAL\', \'M1\')" style="display: inline-block;"> MRT route, segment M1</a ></li> Signage with Tan Tock Seng Hospital’s logo from the MRT station to the hospital. Assumes visitors can either read or were familiar with the logo. <br><br><img src="survey-pictures/TTSH-M1-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'TAN TOCK SENG HOSPITAL\', \'M2\')" style="display: inline-block;"> MRT route, segment M2</a ></li> The signage assumed that visitors could read the signs. Nonetheless, the signage was in a suitable position and clear. <br><br><img src="survey-pictures/TTSH-M2-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'TAN TOCK SENG HOSPITAL\', \'B1\')" style="display: inline-block;">Bus route, segment B1</a></li>Only signage on the construction shelter towards the Velocity shopping mall, but not Tan Tock Seng Hospital. Not clear that visitors had to first enter the Velocity to access the hospital. However, there were staff present in various retail shops along the segment to ask for directions assistance.<br><br><img src="survey-pictures/TTSH-B1-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><br><li><a href="#" onclick="zoomToPolyline(\'TAN TOCK SENG HOSPITAL\', \'B2\')" style="display: inline-block;">Bus route, segment B2</a></li>It was easy to miss the wayfinding signage to the linkbridge to TTSH in this segment, as they were not only absent at the end of segment B1 from the bus stop, but located only towards the end of the right turn from the end of segment B1 within the Square 2 shopping mall. The amount of wayfinding signage only increased after making the crucial right turn and going up the escalator. <br><br>In addition, the signage was found to be unclear due to the small font. There was no use of symbols and were only understood if visitors had language skills<br><br><img src="survey-pictures/TTSH-B2-wayfinding.jpg" style="max-width: 100%; height: auto;"><br><img src="survey-pictures/TTSH-B2-wayfinding-2.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/TTSH-B2-wayfinding-3.jpg" style="max-width: 100%; height: auto;"><br><img src="survey-pictures/TTSH-B2-wayfinding-4.jpg" style="max-width: 100%; height: auto;"><br><br><li><a href="#" onclick="zoomToPolyline(\'TAN TOCK SENG HOSPITAL\', \'B3\')" style="display: inline-block;">Bus route, segment B3</a></li>Presence of wayfinding signage that indicated visitors were entering TTSH from the linkbridge within the Square 2 shopping mall, as well as presence of a detailed directory showing the map of TTSH and its clinics. These still required language skills to interpret.<br><br><img src="survey-pictures/TTSH-B3-wayfinding.jpg" style="max-width: 100%; height: auto;"> <br><img src="survey-pictures/TTSH-B3-wayfinding-2.jpg" style="max-width: 100%; height: auto;"><br><br>';
            } else {
                content = "";
            }

            content += "<center><a href='#top'>Back to Top</a></center></div>";

            return content;
        }

        // Function to zoom to the polyline with specific hospName and segment
        function zoomToPolyline(hospName, segment) {
            // Find the polyline with matching hospName and segment
            const matchingPolyline = polylines.find(
                (polyline) =>
                    polyline.options.hospName === hospName &&
                    polyline.options.segment === segment
            );

            if (matchingPolyline) {
                // Zoom in to the polyline's bounds
                map.fitBounds(matchingPolyline.getBounds());

                // Remove previous highlight
                removePolylineHighlight();

                // Highlight the matching polyline
                highlightPolyline(matchingPolyline);

                // Scroll to the content associated with the polyline
                const contentContainer = document.getElementById("scrollableContent");
                if (contentContainer) {
                    const contentElements = contentContainer.getElementsByClassName("content-wrapper");

                    for (let i = 0; i < contentElements.length; i++) {
                        const contentElement = contentElements[i];
                        const contentSegment = contentElement.getAttribute("data-segment");
                        if (contentSegment === segment) {
                            contentContainer.scrollTop = contentElement.offsetTop;
                            break;
                        }
                    }
                }
            }

            // Scroll to the content associated with the polyline
            const anchor = document.getElementById("segment-" + segment);
            if (anchor) {
                anchor.scrollIntoView({ behavior: "smooth" });
            }

        }

        // Function to highlight the polyline with a glowing effect
        function highlightPolyline(polyline) {
            // Create a PolylineDecorator instance for the selected polyline
            const decorator = L.polylineDecorator(polyline, {
                patterns: [
                    {
                        offset: 0,
                        repeat: 10,
                        symbol: L.Symbol.dash({
                            pixelSize: 12,
                            pathOptions: { color: "yellow", weight: 3 },
                        }),
                    },
                ],
            }).addTo(map);

            // Store the decorator instance in a global variable for future reference
            highlightedDecorator = decorator;
        }

        // Function to remove the highlight from the polyline
        function removePolylineHighlight() {
            if (highlightedDecorator) {
                // Remove the decorator from the map
                map.removeLayer(highlightedDecorator);

                // Reset the global variable
                highlightedDecorator = null;
            }
        }

        // Define the CSV file path
        const csvFilePath = "walkability-audit.csv";

        // Initialize Leaflet map
        const map = L.map("map").setView([1.35, 103.85], 15);

        // Add the map tile layer to the map
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution:
                'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
            opacity: 0.5, // Set the opacity of the tile layer
        }).addTo(map);

        // Initialize an empty array to store the polylines
        const polylines = [];
        // Declare the highlightedDecorator variable globally
        let highlightedDecorator = null;

        // Define the CSV file path for the second file
        const csvFilePath2 = "transport-hospitals-lastmile-agg.csv";

        // Create custom icons for markers
        const busIconOptions = {
            iconUrl: "icons/bus-stop.png",
            iconSize: [25, 25],
            iconAnchor: [12, 24],
        };

        const mrtIconOptions = {
            iconUrl: "icons/train.png",
            iconSize: [25, 25],
            iconAnchor: [12, 24],
        };

        const endIconOptions = {
            iconUrl: "icons/hospital.png",
            iconSize: [25, 25],
            iconAnchor: [12, 24],
        };

        const busIcon = L.icon(busIconOptions);
        const mrtIcon = L.icon(mrtIconOptions);
        const endIcon = L.icon(endIconOptions);

        // Declare uniqueHospitals object to track unique hospital names
        const uniqueHospitals = {};

        // Parse 2nd CSV file
        Papa.parse(csvFilePath2, {
            header: true,
            download: true,
            dynamicTyping: true,
            complete: function (results) {
                const data = results.data;

                // Process the data columns
                for (let i = 0; i < data.length; i++) {
                    const row = data[i];
                    const busLat = row.busLat;
                    const busLong = row.busLong;
                    const mrtLat = row.mrtLat;
                    const mrtLong = row.mrtLong;
                    const clinicLat = row.clinicLat;
                    const clinicLong = row.clinicLong;
                    const clinicName = row.clinicName;
                    const SOCname = row.SOCname;
                    const mrtNameExit = row.mrtNameExit;
                    const busLocation = row.busLocation1;
                    const mean_mrt = row.mean_wayfinding_checklist_MRT;
                    const mean_bus = row.mean_wayfinding_checklist_Bus;

                    const hospName = clinicName;

                    if (!uniqueHospitals[hospName]) {
                        // Create a link in the sidebar for the first instance of each hospital
                        const sidebar = document.getElementById("hospitalTable");
                        const row = document.createElement("tr");

                        const nameCell = document.createElement("td");
                        const nameLink = document.createElement("a");
                        nameLink.textContent = hospName;
                        nameLink.addEventListener("click", function () {
                            // Zoom in to the last marker of the selected hospital
                            map.setView([clinicLat, clinicLong], 17);

                            // Zoom to the polyline and scroll to the content
                            zoomToPolyline(hospName, mrtNameExit);
                        });
                        nameCell.appendChild(nameLink);
                        row.appendChild(nameCell);

                        const mrtCell = document.createElement("td");
                        mrtCell.textContent = mean_mrt;
                        row.appendChild(mrtCell);

                        const busCell = document.createElement("td");
                        busCell.textContent = mean_bus;
                        row.appendChild(busCell);

                        sidebar.appendChild(row);

                        uniqueHospitals[hospName] = true; // Mark the hospital as unique
                    }

                    // Create markers for the start and end points with the custom icons
                    const busMarker = L.marker([busLat, busLong], { icon: busIcon });
                    const mrtMarker = L.marker([mrtLat, mrtLong], { icon: mrtIcon });
                    const endMarker = L.marker([clinicLat, clinicLong], { icon: endIcon });

                    // Create popups for the markers
                    busMarker.bindPopup("Bus Stop Location: " + busLocation);
                    mrtMarker.bindPopup("MRT Station Exit: " + mrtNameExit);
                    endMarker.bindPopup("Destination: " + SOCname);

                    // Create a content wrapper for the marker in the scrollableContent
                    const markerContent = getUniqueHTMLForHospName(hospName, mrtNameExit);
                    const contentWrapper = document.createElement("div");
                    contentWrapper.className = "content-wrapper";
                    contentWrapper.setAttribute("data-segment", mrtNameExit);
                    contentWrapper.innerHTML = markerContent;
                    document.getElementById("scrollableContent").appendChild(contentWrapper);

                    // Add the markers to the map
                    busMarker.addTo(map);
                    mrtMarker.addTo(map);
                    endMarker.addTo(map);
                }
            },
        });


        // Parse the 1st CSV file
        Papa.parse(csvFilePath, {
            header: true,
            download: true,
            dynamicTyping: true,
            complete: function (results) {
                const data = results.data;

                // Define the color scale for the intensity levels
                const colorScale = chroma.scale(["green", "orange", "red"]).domain([6, 0]);

                // Process the data columns
                for (let i = 0; i < data.length; i++) {
                    const row = data[i];
                    const geometry = row.geometry;
                    const hospName = row.hospName;
                    const segment = row.segment;
                    const paths_involved = row.paths_involved;
                    const wayfinding_checklist = row.wayfinding_checklist;

                    if (geometry && typeof geometry === "string") {
                        // Extract coordinates from LINESTRING
                        const coordinates = geometry
                            .match(/-?\d+\.\d+/g)
                            .map((coord, index, array) => {
                                // Swap latitude and longitude
                                if (index % 2 === 0) {
                                    return [parseFloat(array[index + 1]), parseFloat(coord)];
                                }
                            })
                            .filter((coord) => coord !== undefined);

                        // Create polylines from the coordinates
                        const polyline = L.polyline(coordinates, {
                            color: colorScale(wayfinding_checklist).hex(),
                            opacity: 0.8,
                            weight: 5, // Set the thickness of the polyline
                            hospName: hospName, // Store hospName as a property of the polyline
                            segment: segment, // Store segment as a property of the polyline
                        }).addTo(map);

                        // Create a tooltip content with 'hospName' and 'segment'
                        const tooltipContent = `<b>${hospName}</b><br>Segment: ${segment}<br>Path types: ${paths_involved}<br>Wayfinding score: ${wayfinding_checklist} / 6`;

                        // Add a tooltip to the polyline
                        polyline.bindTooltip(tooltipContent, {
                            permanent: false,
                            direction: "auto",
                        });

                        polylines.push(polyline);
                    }
                }

                // Fit the map to show all polylines
                const polylineGroup = L.featureGroup(polylines);
                map.fitBounds(polylineGroup.getBounds());
            },
        });

    </script>
</body>

</html>